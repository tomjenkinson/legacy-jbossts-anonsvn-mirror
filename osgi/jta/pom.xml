<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<!-- JBoss, Home of Professional Open Source Copyright 2009, Red Hat Middleware 
		LLC, and individual contributors as indicated by the @author tags. See the 
		copyright.txt in the distribution for a full listing of individual contributors. 
		This copyrighted material is made available to anyone wishing to use, modify, 
		copy, or redistribute it subject to the terms and conditions of the GNU Lesser 
		General Public License, v. 2.1. This program is distributed in the hope that 
		it will be useful, but WITHOUT A WARRANTY; without even the implied warranty 
		of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser 
		General Public License for more details. You should have received a copy 
		of the GNU Lesser General Public License, v.2.1 along with this distribution; 
		if not, write to the Free Software Foundation, Inc., 51 Franklin Street, 
		Fifth Floor, Boston, MA 02110-1301, USA. (C) 2009, @author JBoss Inc. (jonathan.halliday@redhat.com) -->
   <parent>
	   <groupId>org.jboss.narayana.osgi</groupId>
	   <artifactId>narayana-osgi-parent</artifactId>
	   <version>5.0.3.Final</version>
	   <relativePath>../pom.xml</relativePath>
   </parent>

   <modelVersion>4.0.0</modelVersion>

   <groupId>org.jboss.narayana.osgi</groupId>
   <artifactId>narayana-osgi-jta</artifactId>
   <packaging>bundle</packaging>

   <name>Narayana: OSGi Transaction Service Bundles - JTA</name>
   <description>Narayana: OSGi JTA Bundles</description>

   <properties>
	   <maven-bundle-plugin.version>2.4.0</maven-bundle-plugin.version>
   </properties>

   <dependencies>
	   <dependency>
		   <groupId>org.osgi</groupId>
		   <artifactId>org.osgi.core</artifactId>
	   </dependency>
	   <dependency>
		   <groupId>org.jboss.osgi.metadata</groupId>
		   <artifactId>jbosgi-metadata</artifactId>
	   </dependency>
	   <dependency>
		   <groupId>org.jboss.arquillian.junit</groupId>
		   <artifactId>arquillian-junit-container</artifactId>
	   </dependency>
	   <dependency>
		   <groupId>org.jboss.spec.javax.transaction</groupId>
		   <artifactId>jboss-transaction-api_1.2_spec</artifactId>
		   <version>${version.org.jboss.spec.javax.transaction}</version>
	   </dependency>
	   <dependency>
		   <groupId>junit</groupId>
		   <artifactId>junit</artifactId>
		   <version>${version.junit}</version>
		   <scope>test</scope>
	   </dependency>
	   <dependency>
		   <groupId>org.jboss.narayana.jta</groupId>
		   <artifactId>jta</artifactId>
		   <version>${project.version}</version>
	   </dependency>
	   <dependency>
		   <groupId>org.jboss.narayana</groupId>
		   <artifactId>common</artifactId>
		   <version>${project.version}</version>
	   </dependency>
	   <dependency>
           <groupId>org.jboss.narayana.arjunacore</groupId>
		   <artifactId>arjuna</artifactId>
		   <version>${project.version}</version>
	   </dependency>
	   <dependency>
		   <groupId>org.jboss.logging</groupId>
		   <artifactId>jboss-logging</artifactId>
		   <version>${version.org.jboss.logging.jboss-logging}</version>
	   </dependency>
   </dependencies>
   <build>
	   <resources>
		   <resource>
			   <directory>${project.basedir}/src/main/resources</directory>
			   <filtering>true</filtering>
			   <includes>
				   <include>features.xml</include>
			   </includes>
		   </resource>
		   <resource>
			   <directory>${project.basedir}/src/main/resources</directory>
			   <filtering>false</filtering>
			   <includes>
				   <include>**/*</include>
			   </includes>
			   <excludes>
				   <exclude>features.xml</exclude>
			   </excludes>
		   </resource>
	   </resources>
	   <pluginManagement>
		   <plugins>
			   <plugin>
				   <artifactId>maven-surefire-plugin</artifactId>
				   <configuration>
					   <skip>true</skip>
				   </configuration>
			   </plugin>
		   </plugins>
	   </pluginManagement>
	   <plugins>
		   <plugin>
			   <groupId>org.apache.felix</groupId>
			   <artifactId>maven-bundle-plugin</artifactId>
			   <version>${maven-bundle-plugin.version}</version>
			   <extensions>true</extensions>
			   <configuration>
				   <instructions>
					   <Bundle-SymbolicName>${project.artifactId}</Bundle-SymbolicName>
					   <Bundle-Version>${project.version}</Bundle-Version>
					   <Bundle-Activator>org.jboss.narayana.osgi.jta.internal.Activator</Bundle-Activator>
					   <Export-Package>
						   org.jboss.narayana.osgi.jta;version=${project.version},
						   javax.transaction*;version="1.1.0"
					   </Export-Package>
					   <Private-Package>org.jboss.narayana.osgi.jta.internal</Private-Package>
					   <Import-Package>
						   javax.management, 
						   javax.naming, 
						   javax.naming.spi, 
						   javax.xml.parsers,
						   javax.transaction, 
						   org.xml.sax,
						   org.xml.sax.helpers,
						   org.osgi.framework,
						   org.w3c.dom,
						   *

						   <!-- excludes -->
						   !com.arjuna.ArjunaOTS, 
						   !com.arjuna.ats.internal*,
						   !javax.resource.spi, 
						   !javax.resource.spi.work, 
						   !javax.sql, 
						   !javax.swing, 
						   !javax.swing.tree, 
						   !oracle.jdbc.xa, 
						   !oracle.jdbc.xa.client, 
						   !oracle.sql, 
						   !org.apache.log4j, 
						   !org.apache.xml.serialize, 
						   !org.omg.*,
					   </Import-Package>
					   <Embed-Transitive>true</Embed-Transitive>
					   <Embed-Dependency>
						   jboss-transaction-api_1.2_spec;inline=false,
						   jboss-logging;inline=false,
						   jta;inline=false,
						   common;inline=false,
						   arjuna;inline=false,
					   </Embed-Dependency>
					   <_exportcontents>
					       javax.transaction
					   </_exportcontents>
					   <Export-Service>
						   javax.transaction.TransactionManager,
						   javax.transaction.TransactionSynchronizationRegistry,
						   javax.transaction.UserTransaction
					   </Export-Service>
					   <_include>src/main/resources/META-INF/MANIFEST.MF</_include>
			   </instructions>
		   </configuration>
	   </plugin>
	   <plugin>
		   <groupId>org.codehaus.mojo</groupId>
		   <artifactId>build-helper-maven-plugin</artifactId>
		   <executions>
			   <execution>
				   <id>attach-artifacts</id>
				   <phase>package</phase>
				   <goals>
					   <goal>attach-artifact</goal>
				   </goals>
				   <configuration>
					   <artifacts>
						   <artifact>
							   <file>target/classes/features.xml</file>
							   <type>xml</type>
							   <classifier>features</classifier>
						   </artifact>
					   </artifacts>
				   </configuration>
			   </execution>
		   </executions>
	   </plugin>
   </plugins>
   </build>
   <profiles>
	   <profile>
		   <id>arq-karaf-embedded</id>
		   <activation>
			   <activeByDefault>false</activeByDefault>
		   </activation>
		   <build>
			   <plugins>
				   <plugin>
					   <artifactId>maven-surefire-plugin</artifactId>
					   <configuration>
						   <skip>false</skip>
						   <argLine>${surefire.system.args}</argLine>
						   <redirectTestOutputToFile>true</redirectTestOutputToFile>
						   <workingDirectory>.</workingDirectory>
						   <systemPropertyVariables>
							   <log4j.configuration>file://${basedir}/src/test/resources/logging.properties</log4j.configuration>
							   <version.apache.karaf>2.3.3</version.apache.karaf>
						   </systemPropertyVariables>
					   </configuration>
				   </plugin>
				   <plugin>
					   <artifactId>maven-dependency-plugin</artifactId>
					   <executions>
						   <execution>
							   <id>unpack-karaf</id>
							   <phase>process-test-resources</phase>
							   <goals>
								   <goal>unpack</goal>
							   </goals>
							   <configuration>
								   <artifactItems>
									   <artifactItem>
										   <groupId>org.apache.karaf</groupId>
										   <artifactId>apache-karaf</artifactId>
										   <version>${version.apache.karaf}</version>
										   <classifier>minimal</classifier>
										   <type>tar.gz</type>
										   <outputDirectory>${project.build.directory}</outputDirectory>
									   </artifactItem>
								   </artifactItems>
							   </configuration>
						   </execution>
					   </executions>
				   </plugin>
			   </plugins>
		   </build>
		   <dependencies>
			   <dependency>
				   <groupId>org.jboss.arquillian.container</groupId>
				   <artifactId>arquillian-container-karaf-embedded</artifactId>
				   <version>${version.org.jboss.arquillian.osgi.karaf}</version>
				   <scope>test</scope>
			   </dependency>
			   <dependency>
				   <groupId>org.jboss.shrinkwrap</groupId>
				   <artifactId>shrinkwrap-depchain</artifactId>
				   <version>${version.shrinkwrap}</version>
				   <type>pom</type>
			   </dependency>
			   <dependency>
				   <groupId>org.slf4j</groupId>
				   <artifactId>slf4j-log4j12</artifactId>
				   <version>${version.org.slf4j}</version>
				   <scope>test</scope>
			   </dependency>
		   </dependencies>
	   </profile>
   </profiles>
   </project>
